---
title: "HCAMP IMPACT Data Summary and Time Between Baseline Data"
output:
  html_document:
    toc: true
    toc_float: true
    theme: spacelab
    highlight: tango 
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

```{r, overall-plots, include=FALSE}
library(tidyverse)
library(here)
library(janitor)
library(rio)
library(colorblindr)
library(gghighlight)
library(forcats)
library(ggrepel)
library(gt)
library(knitr)
library(kableExtra)
library(reactable)
library(plotly)
library(glue)
library(fs)
library(rstatix)
library(ggpubr)

theme_set(theme_minimal(15) +
            theme(legend.position = "bottom",
                  panel.grid.major.x = element_line(color = "gray60"),
                  panel.grid.minor.x = element_blank(),
                  panel.grid.major.y = element_blank())
          )


files <- dir_ls(here::here("ImPACT_data"), glob = "*.csv")

d <- map_df(files, read_csv, .id = "file",
                 col_types = cols(.default = "c")) %>% 
  modify(~parse_guess(.x)) %>% 
  janitor::clean_names() %>% 
  mutate(year = parse_number(file)) %>% 
  mutate(year = as.factor(year))

mean_2 <- function(x) {
  z <- na.omit(x)
  sum(z) / length(z)
}

str(d)
d$user_symptom22delayed
d$user_symptom11delayed

impact2 <- d %>% 
  mutate(user_gender = as.factor(user_gender),
         user_handedness = as.factor(user_handedness),
         user_height = as.factor(user_height),
         user_weight = as.factor(user_weight),
         user_country = as.factor(user_country),
         user_first_language = as.factor(user_first_language),
         user_second_language = as.factor(user_second_language),
         user_education_level = as.factor(user_education_level),
         user_special_ed1 = as.factor(user_special_ed1),
         user_special_ed2 = as.factor(user_special_ed2),
         user_special_ed3 = as.factor(user_special_ed3),
         user_special_ed4 = as.factor(user_special_ed4),
         user_special_ed5 = as.factor(user_special_ed5),
         add_adhd = as.factor(add_adhd),
         dyslexia = as.factor(dyslexia),
         autism = as.factor(autism),
         user_treatment_received1 = as.factor(user_treatment_received1),
         user_treatment_received2 = as.factor(user_treatment_received2),
         user_treatment_received3 = as.factor(user_treatment_received3),
         user_treatment_received4 = as.factor(user_treatment_received4),
         user_treatment_received5 = as.factor(user_treatment_received5),
         user_treatment_received6 = as.factor(user_treatment_received6),
         user_treatment_received7 = as.factor(user_treatment_received7),
         user_current_sport = as.factor(user_current_sport),
         user_primary_position = as.factor(user_primary_position),
         user_level_of_participation = as.factor(user_level_of_participation),
         user_years_playing = as.factor(user_years_playing),
         user_number_of_concussions = as.factor(user_number_of_concussions),
         user_concussion_type1 = as.factor(user_concussion_type1),
         user_concussion_type2 = as.factor(user_concussion_type2),
         user_concussion_type3 = as.factor(user_concussion_type3),
         user_concussion_type4 = as.factor(user_concussion_type4),
         user_total_games_missed = as.factor(user_total_games_missed),
         user_concussion_history = as.factor(user_concussion_history),
         user_last_concussion_date = as.factor(user_last_concussion_date),
         test_type = as.factor(test_type),
         test_date = as.factor(test_date),
         exam_language = as.factor(exam_language),
         test_version = as.factor(test_version),
         word_memory_lp = as.factor(word_memory_lp),
         word_memory_dm_correct = as.factor(word_memory_dm_correct),
         word_memory_total_percent_correct = as.factor(word_memory_total_percent_correct),
         design_memory_lp = as.factor(design_memory_lp),
         design_memory_dm_correct = as.factor(design_memory_dm_correct),
         design_memory_total_percent_correct = as.factor(design_memory_total_percent_correct),
         x_oaverage_incorrect = as.factor(x_oaverage_incorrect),
         three_letters_percentage_letters_correct = as.factor(three_letters_percentage_letters_correct),
         user_symptom1delayed = as.factor(user_symptom1delayed))

str(impact2)

impact2$user_symptom1delayed


impact3 <- impact2 %>% 
  mutate(user_height = as.numeric(user_height),
         user_weight = as.numeric(user_weight),
         user_education_level = as.numeric(user_education_level),
         user_years_playing = as.numeric(user_years_playing),
         user_number_of_concussions = as.numeric(user_number_of_concussions),
         user_concussion_type1 = as.numeric(user_concussion_type1),
         user_concussion_type2 = as.numeric(user_concussion_type2),
         user_concussion_type3 = as.numeric(user_concussion_type3),
         user_concussion_type4 = as.numeric(user_concussion_type4),
         user_total_games_missed = as.numeric(user_total_games_missed),
         word_memory_lp = as.numeric(word_memory_lp),
         word_memory_dm_correct = as.numeric(word_memory_dm_correct),
         word_memory_total_percent_correct = as.numeric(word_memory_total_percent_correct),
         design_memory_lp = as.numeric(design_memory_lp),
         design_memory_dm_correct = as.numeric(design_memory_dm_correct),
         design_memory_total_percent_correct = as.numeric(design_memory_total_percent_correct),
         x_oaverage_incorrect = as.numeric(x_oaverage_incorrect),
         three_letters_percentage_letters_correct = as.numeric(three_letters_percentage_letters_correct),
         user_symptom1delayed = as.numeric(user_symptom1delayed))

str(impact3)

mean_2(impact3$user_symptom1delayed)
mean_2(impact3$user_symptom2delayed)

impact <- impact3

str(impact)

tbl_variables <- impact %>% 
  select(year, 
         passport_id, 
         user_age, 
         user_gender, 
         user_current_sport, 
         user_level_of_participation, 
         user_number_of_concussions,
         test_type) %>% 
  mutate(user_current_sport = fct_explicit_na(user_current_sport))

tbl_variables %>% 
  count(user_current_sport)


```

# Data Summary {.tabset .tabset-fade .tabset-pills}

The data summary section provides information on the total number of ImPACT tests administered from 2000 - 2020. The _2010_ year displayed on the plots and tables represents the years 2000 - 2010. Within the data summary section, the total number of administered ImPACT tests is broken down by specific variables included in the ImPACT dataset, including participant gender, participant sport, and the type of test administered (e.g. baseline, post-injury 1, post-injury 2). 

## Gender Table
```{r gender table, include=FALSE}

gender_tbl <- tbl_variables %>% 
  group_by(year, user_gender) %>% 
  summarize(total = n()) %>% 
  na.omit() %>% 
  reactable(
    columns = list(
      year = colDef(name = "Year"),
      user_gender = colDef(name = "Gender"),
      total = colDef(name = "Total Tests",
                     format = colFormat(separators = TRUE))),
    pagination = TRUE,
    striped = TRUE,
    outlined = TRUE,
    compact = TRUE,
    highlight = TRUE,
    bordered = TRUE,
    searchable = TRUE
  )

gender_tbl

gender_plot <- tbl_variables %>% 
  group_by(year) %>% 
  count(user_gender)

gen_plot <- ggplot(gender_plot, aes(user_gender, n)) +
  geom_col(fill = "blue",
           alpha = 0.7) +
  geom_text(aes(user_gender, n, label = n),
            vjust = 1.5,
            color = "white") +
  facet_wrap(~year) +
  labs(x = "",
       y = "Total Tests",
       title = "Test Administrations by Gender")
```

```{r gender table print, include=TRUE}
gender_tbl
```

## Gender Plot
```{r gender plot, include=TRUE, fig.height=8}
gen_plot
```

## Sport Table
```{r sport table, include=FALSE}

sport_tbl <- tbl_variables %>% 
  group_by(year, user_current_sport) %>% 
  summarize(total = n()) %>% 
  na.omit() %>% 
  reactable(
    columns = list(
      year = colDef(name = "Year"),
      user_current_sport = colDef(name = "Sport"),
      total = colDef(name = "Total Tests",
                     format = colFormat(separators = TRUE))),
    pagination = TRUE,
    striped = TRUE,
    outlined = TRUE,
    compact = TRUE,
    highlight = TRUE,
    bordered = TRUE,
    searchable = TRUE
  )

sport_tbl

sport_plot <- tbl_variables %>% 
  group_by(user_current_sport) %>% 
  count(user_current_sport)

sp_plot <- ggplot(sport_plot, aes(fct_reorder(user_current_sport, n), n)) +
  geom_col(fill = "blue",
           alpha = 0.7) +
  coord_flip() +
  labs(x = "",
       y = "Total Tests",
       title = "Test Administrations by Sport")


sp_top_20 <- tbl_variables %>% 
  group_by(user_current_sport) %>% 
  count(user_current_sport) %>% 
  arrange(desc(n)) %>% 
  filter(n >= 500)

sp_bottom <- tbl_variables %>% 
  group_by(user_current_sport) %>% 
  count(user_current_sport) %>% 
  arrange(n) %>% 
  filter(n <= 500)

sp_top_plot <- ggplot(sp_top_20, aes(fct_reorder(user_current_sport, n), n)) +
  geom_col(fill = "blue",
           alpha = 0.7) +
  coord_flip() +
  geom_text(aes(user_current_sport, n, label = n),
            hjust = 1.1,
            nudge_y = 0.02,
            size = 3,
            color = "white") +
  labs(x = "",
       y = "Total Tests",
       title = "Test Administrations by Sport")

sport_plot_fun <- function(df) {
  ggplot(df, aes(fct_reorder(user_current_sport, n), n)) +
  geom_col(fill = "blue",
           alpha = 0.7) +
  coord_flip() +
  geom_text(aes(user_current_sport, n, label = n),
            hjust = 1.1,
            nudge_y = 0.02,
            size = 8,
            color = "white") +
  labs(x = "",
       y = "Total Tests",
       title = "Test Administrations by Sport")
}

sport_plot_fun(sp_top_20)

sp_bottom_plot <- ggplot(sp_bottom, aes(fct_reorder(user_current_sport, n), n)) +
  geom_col(fill = "blue",
           alpha = 0.7) +
  coord_flip() +
  geom_text(aes(user_current_sport, n, label = n),
            hjust = -0.5,
            nudge_y = 0.02,
            size = 3) +
  labs(x = "",
       y = "Total Tests",
       title = "Test Administrations by Sport")
```

```{r sport table print, include=TRUE}
sport_tbl
```

## Most Tested Sports
```{r sport plot 1, include=TRUE, fig.height=10}
sp_top_plot
```

## Least Tested Sports
```{r sport plot 2, include=TRUE, fig.height=10, fig.width=10}
sp_bottom_plot
```

## Test Type Table
```{r test type, include=FALSE}
head(tbl_variables)

test_tbl <- tbl_variables %>% 
  group_by(year, test_type) %>% 
  summarize(total = n()) %>% 
  na.omit() %>% 
  reactable(
    columns = list(
      year = colDef(name = "Year"),
      test_type = colDef(name = "Test Type"),
      total = colDef(name = "Total Tests",
                     format = colFormat(separators = TRUE))),
    pagination = TRUE,
    striped = TRUE,
    outlined = TRUE,
    compact = TRUE,
    highlight = TRUE,
    bordered = TRUE,
    searchable = TRUE
  )
```

```{r test type table, include=TRUE}
test_tbl
```

## Total Tests 

  * Total number of ImPACT tests administered 2000-2020
  
  * ++ indicates invalid Basline tests 
  
```{r total test, include=FALSE}
test_total <- tbl_variables %>% 
  group_by(test_type) %>% 
  summarize(total = n()) %>% 
  na.omit() %>% 
  reactable(
    columns = list(
      test_type = colDef(name = "Test Type"),
      total = colDef(name = "Total Tests",
                     format = colFormat(separators = TRUE))),
    pagination = TRUE,
    striped = TRUE,
    outlined = TRUE,
    compact = TRUE,
    highlight = TRUE,
    bordered = TRUE,
    searchable = TRUE
  )
```

```{r total test table, include=TRUE}
test_total
```

## Test Plot
```{r test plot data, include=FALSE}
test_plot <- tbl_variables %>% 
  group_by(year) %>% 
  count(test_type)

tst_plot <- ggplot(test_plot, aes(test_type, n)) +
  geom_col(fill = "blue",
           alpha = 0.7) +
  coord_flip() +
  facet_wrap(~year) +
  labs(x = "",
       y = "Total Tests",
       title = "Test Administrations by Type")
```

```{r test plot, include=TRUE, fig.height=12, fig.width=12}
tst_plot
```

```{r code needed for rest of document, include=FALSE}

## 6.30.20 - the data is fixed now for all needed values - don't use str() to change names - that messed up data vaules - take this code to a new document to make baseline link - repeat process for post-injury 1


test_time <- impact %>% 
  select(year,
         passport_id, 
         user_gender, 
         user_age, 
         test_type, 
         test_date, 
         test_version, 
         user_current_sport,
         user_number_of_concussions,
         user_education_level,
         user_memory_composite_score_verbal,
         user_memory_composite_score_visual,
         user_impulse_control_composite_score,
         user_reaction_time_composite_score,
         user_impulse_control_composite_score,
         user_visual_motor_composite_score) 

impact$user_visual_motor_composite_score
test_time$user_visual_motor_composite_score

str(test_time)

test_time$test_type
test_time$user_visual_motor_composite_score

#test_time <- test_time %>% 
  #mutate_all(funs(str_replace(., "Post-Injury 1", "Post_Injury_1")))

#test_time <- test_time %>% 
  #mutate_all(funs(str_replace(., "Post-Injury 2", "Post_Injury_2")))

#test_time <- test_time %>% 
  #mutate_all(funs(str_replace(., "Post-Injury 3", "Post_Injury_3")))

#test_time <- test_time %>% 
  #mutate_all(funs(str_replace(., "Post-Injury 4", "Post_Injury_4")))

#test_time <- test_time %>% 
  #mutate_all(funs(str_replace(., "Baseline ++", "Baseline_inv")))

test_time$test_type

str(test_time)

test_time$user_memory_composite_score_verbal
impact$user_memory_composite_score_verbal
impact$user_visual_motor_composite_score
test_time$user_visual_motor_composite_score

test_time <- test_time %>% 
  filter(test_type != "Baseline ++")

test_time <- test_time %>% 
  filter(test_type != "Post-Injury 2")

test_time <- test_time %>% 
  filter(test_type != "Post-Injury 3")

test_time <- test_time %>% 
  filter(test_type != "Post-Injury 4")

test_time
test_time$user_visual_motor_composite_score


str(test_time)
test_time$user_visual_motor_composite_score

test_time %>% 
  arrange(passport_id)

str(test_time)

baseline <- test_time %>% 
  filter(test_type == "Baseline")

str(baseline)

baseline3 <- baseline %>% 
  group_by(passport_id) %>% 
  filter(n() > 1) %>% 
  mutate(baseline_number = row_number()) %>% 
  spread(baseline_number, test_type, sep = "_") %>% 
  arrange(passport_id)

multiple_baseline <- baseline3

baseline3 <- baseline3[, -c(17:23)]

str(baseline3)

baseline3 %>% 
  count(passport_id)


# 6.12.20 This code below is what's needed for markdown file
head(baseline3)

baseline3$test_date <- as.Date(baseline3$test_date, format = "%m/%d/%Y")

mem_verbal <- baseline3 %>% 
  group_by(passport_id) %>% 
  mutate(number = row_number()) %>% 
  ungroup() %>% 
  pivot_wider(
    id_cols = passport_id,
    names_from = number,
    values_from = c(test_date, user_memory_composite_score_verbal),
    names_glue = "{.value}_{number}"
  ) %>% 
  mutate(time_between = test_date_2 - test_date_1) 

mem_verbal <- mem_verbal %>% 
  select(passport_id, 
         test_date_1, 
         test_date_2, 
         user_memory_composite_score_verbal_1, 
         user_memory_composite_score_verbal_2,
         time_between) %>% 
  mutate(memory_verbal_diff = user_memory_composite_score_verbal_2 - user_memory_composite_score_verbal_1)

mem_verbal_all <- mem_verbal

mem_verbal <- mem_verbal %>% 
  filter(memory_verbal_diff >= 0)

mem_verbal <- mem_verbal %>% 
  mutate(memory_verbal_percent_inc = memory_verbal_diff / user_memory_composite_score_verbal_1 * 100)

mean_2(mem_verbal$memory_verbal_diff)
mean_2(mem_verbal$time_between)
mean_2(mem_verbal$memory_verbal_percent_inc)

mem_visual <- baseline3 %>% 
  group_by(passport_id) %>% 
  mutate(number = row_number()) %>% 
  ungroup() %>% 
  pivot_wider(
    id_cols = passport_id,
    names_from = number,
    values_from = c(test_date, user_memory_composite_score_visual),
    names_glue = "{.value}_{number}"
  ) %>% 
  mutate(time_between = test_date_2 - test_date_1) 

mem_visual <- mem_visual %>% 
  select(passport_id, 
         test_date_1, 
         test_date_2, 
         user_memory_composite_score_visual_1, 
         user_memory_composite_score_visual_2,
         time_between) %>% 
  mutate(memory_visual_diff = user_memory_composite_score_visual_2 - user_memory_composite_score_visual_1)

mem_visual_all <- mem_visual

mem_visual <- mem_visual %>% 
  filter(memory_visual_diff >= 0)

mean_2(mem_visual$memory_visual_diff)
mean_2(mem_visual$time_between)

mem_visual <- mem_visual %>% 
  mutate(memory_visual_percent_inc = memory_visual_diff / user_memory_composite_score_visual_1 * 100)

impulse_control <- baseline3 %>% 
  group_by(passport_id) %>% 
  mutate(number = row_number()) %>% 
  ungroup() %>% 
  pivot_wider(
    id_cols = passport_id,
    names_from = number,
    values_from = c(test_date, user_impulse_control_composite_score),
    names_glue = "{.value}_{number}"
  ) %>% 
  mutate(time_between = test_date_2 - test_date_1) 

impulse_control <- impulse_control %>% 
  select(passport_id, 
         test_date_1, 
         test_date_2, 
         user_impulse_control_composite_score_1, 
         user_impulse_control_composite_score_2,
         time_between) %>% 
  mutate(impulse_control_diff = user_impulse_control_composite_score_2 - user_impulse_control_composite_score_1)

impulse_control_all <- impulse_control

impulse_control <- impulse_control %>% 
  filter(impulse_control_diff >= 0)

impulse_control <- impulse_control %>% 
  mutate(impulse_control_percent_inc = impulse_control_diff / user_impulse_control_composite_score_1 * 100)

reaction_time <- baseline3 %>% 
  group_by(passport_id) %>% 
  mutate(number = row_number()) %>% 
  ungroup() %>% 
  pivot_wider(
    id_cols = passport_id,
    names_from = number,
    values_from = c(test_date, user_reaction_time_composite_score),
    names_glue = "{.value}_{number}"
  ) %>% 
  mutate(time_between = test_date_2 - test_date_1) 

reaction_time <- reaction_time %>% 
  select(passport_id, 
         test_date_1, 
         test_date_2, 
         user_reaction_time_composite_score_1, 
         user_reaction_time_composite_score_2,
         time_between) %>% 
  mutate(reaction_time_diff = user_reaction_time_composite_score_2 - user_reaction_time_composite_score_1)

reaction_time_all <- reaction_time

reaction_time <- reaction_time %>% 
  filter(reaction_time_diff >= 0)

reaction_time <- reaction_time %>% 
  mutate(reaction_time_percent_inc = reaction_time_diff / user_reaction_time_composite_score_1 * 100)

visual_motor <- baseline3 %>% 
  group_by(passport_id) %>% 
  mutate(number = row_number()) %>% 
  ungroup() %>% 
  pivot_wider(
    id_cols = passport_id,
    names_from = number,
    values_from = c(test_date, user_visual_motor_composite_score),
    names_glue = "{.value}_{number}"
  ) %>% 
  mutate(time_between = test_date_2 - test_date_1) 

visual_motor <- visual_motor %>% 
  select(passport_id, 
         test_date_1, 
         test_date_2, 
         user_visual_motor_composite_score_1, 
         user_visual_motor_composite_score_2,
         time_between) %>% 
  mutate(visual_motor_diff = user_visual_motor_composite_score_2 - user_visual_motor_composite_score_1)

visual_motor_all <- visual_motor

visual_motor <- visual_motor %>% 
  filter(visual_motor_diff >= 0)

visual_motor <- visual_motor %>% 
  mutate(visual_motor_percent_inc = visual_motor_diff / user_visual_motor_composite_score_1 * 100)

mem_verbal <- mem_verbal %>% 
  arrange(passport_id)

mem_visual <- mem_visual %>% 
  arrange(passport_id)

impulse_control <- impulse_control %>% 
  arrange(passport_id)

reaction_time <- reaction_time %>% 
  arrange(passport_id)

visual_motor <- visual_motor %>% 
  arrange(passport_id)

test_join <- full_join(mem_verbal, mem_visual)

test_join2 <- full_join(test_join, impulse_control)

test_join3 <- full_join(test_join2, reaction_time)

baseline_final <- full_join(test_join3, visual_motor)
head(baseline_final)

mean_2(impulse_control$impulse_control_diff)
mean_2(baseline_final$impulse_control_diff)

baseline_all_positive <- baseline_final %>% 
  na.omit()

mean_2(baseline_all_positive$time_between)


mem_verbal %>% 
  summarize(Mean = mean(memory_verbal_diff),
            SD = sd(memory_verbal_diff),
            Min = min(memory_verbal_diff),
            Max = max(memory_verbal_diff),
            Total = length(memory_verbal_diff)) %>% 
  mutate_if(is.numeric, round, 2) %>% 
  reactable()

create_react <- function(df, var) {
    df %>% 
      summarize(Mean = mean({{var}}),
                SD = sd({{var}}),
                Min = min({{var}}),
                Max = max({{var}}),
                Total = length({{var}})) %>% 
      mutate_if(is.numeric, round, 2) %>% 
      reactable(columns = list(
        Mean = colDef(format = colFormat(separators = TRUE)),
        SD = colDef(format = colFormat(separators = TRUE)),
        Min = colDef(format = colFormat(separators = TRUE)),
        Max = colDef(format = colFormat(separators = TRUE)),
        Total = colDef(format = colFormat(separators = TRUE, suffix = " individuals"))
      ))
}

react_percent <- function(df, var) {
  df %>% 
    summarize(Mean = mean({{var}}),
              SD = sd({{var}}),
              Min = min({{var}}),
              Max = max({{var}}),
              Total = length({{var}})) %>% 
    mutate_if(is.numeric, round, 2) %>% 
    reactable(columns = list(
      Mean = colDef(format = colFormat(separators = TRUE, suffix = "%")),
      SD = colDef(format = colFormat(separators = TRUE, suffix = "%")),
      Min = colDef(format = colFormat(separators = TRUE, suffix = "%")),
      Max = colDef(format = colFormat(separators = TRUE, suffix = "%")),
      Total = colDef(format = colFormat(separators = TRUE, suffix = " individuals"))
      ))
}

create_react(mem_verbal, memory_verbal_diff)

react_percent(mem_verbal, memory_verbal_percent_inc)

create_react(mem_visual, memory_visual_diff)

react_percent(mem_visual, memory_visual_percent_inc)

create_react(impulse_control, impulse_control_diff)

react_percent(impulse_control, impulse_control_percent_inc)

create_react(reaction_time, reaction_time_diff)

react_percent(reaction_time, reaction_time_percent_inc)

create_react(visual_motor, visual_motor_diff)

react_percent(visual_motor, visual_motor_percent_inc)

str(baseline_final$time_between)


time_data <- baseline_final %>% 
  mutate(time_between = as.numeric(time_between))

time_data2 <- baseline_all_positive %>% 
  mutate(time_between = as.numeric(time_between))

create_react(time_data, time_between)
create_react(time_data2, time_between)

baseline_tbl1 <- baseline_all_positive %>% 
  select(-time_between)

```

```{r, multiple baselines, include=FALSE}
head(multiple_baseline)

multiple_baseline$test_date <- as.Date(multiple_baseline$test_date, format = "%m/%d/%Y")

#mem verbal organization
multiple_mem_verbal <- multiple_baseline %>% 
  group_by(passport_id) %>% 
  mutate(number = row_number()) %>% 
  ungroup() %>% 
  pivot_wider(
    id_cols = passport_id,
    names_from = number,
    values_from = c(test_date, user_memory_composite_score_verbal),
    names_glue = "{.value}_{number}"
  ) 

one_mem_verbal <- multiple_mem_verbal %>% 
  select(c(1, 2, 11)) %>% 
  arrange(passport_id) %>% 
  na.omit() 


two_mem_verbal <- multiple_mem_verbal %>% 
  select(c(1:3, 11:12)) %>% 
  arrange(passport_id) %>% 
  mutate(time_between = test_date_2 - test_date_1) %>% 
  na.omit()

three_mem_verbal <- multiple_mem_verbal %>% 
  select(c(1:4, 11:13)) %>% 
  arrange(passport_id) %>% 
  mutate(time_between_1_2 = test_date_2 - test_date_1) %>% 
  mutate(time_between_2_3 = test_date_3 - test_date_2) %>% 
  na.omit()

four_mem_verbal <- multiple_mem_verbal %>% 
  select(c(1:5, 11:14)) %>% 
  arrange(passport_id) %>% 
  mutate(time_between_1_2 = test_date_2 - test_date_1) %>% 
  mutate(time_between_2_3 = test_date_3 - test_date_2) %>% 
  mutate(time_between_3_4 = test_date_4 - test_date_3) %>% 
  na.omit()

five_mem_verbal <- multiple_mem_verbal %>% 
  select(c(1:6, 11:15)) %>% 
  arrange(passport_id) %>% 
  mutate(time_between_1_2 = test_date_2 - test_date_1) %>% 
  mutate(time_between_2_3 = test_date_3 - test_date_2) %>% 
  mutate(time_between_3_4 = test_date_4 - test_date_3) %>% 
  mutate(time_between_4_5 = test_date_5 - test_date_4) %>% 
  na.omit()

six_mem_verbal <- multiple_mem_verbal %>% 
  select(c(1:7, 11:16)) %>% 
  arrange(passport_id) %>% 
  na.omit()

seven_mem_verbal <- multiple_mem_verbal %>% 
  select(c(1:8, 11:17)) %>% 
  arrange(passport_id) %>% 
  na.omit()

eight_mem_verbal <- multiple_mem_verbal %>% 
  select(c(1:9, 11:18)) %>% 
  arrange(passport_id) %>% 
  na.omit()

nine_mem_verbal <- multiple_mem_verbal %>% 
  select(c(1:10, 11:19)) %>% 
  arrange(passport_id) %>% 
  na.omit()

#mem visual organization
multiple_mem_visual <- multiple_baseline %>% 
  group_by(passport_id) %>% 
  mutate(number = row_number()) %>% 
  ungroup() %>% 
  pivot_wider(
    id_cols = passport_id,
    names_from = number,
    values_from = c(test_date, user_memory_composite_score_visual),
    names_glue = "{.value}_{number}"
  ) 

one_mem_visual <- multiple_mem_visual %>% 
  select(c(1, 2, 11)) %>% 
  arrange(passport_id) %>% 
  na.omit()

two_mem_visual <- multiple_mem_visual %>% 
  select(c(1:3, 11:12)) %>% 
  arrange(passport_id) %>% 
  mutate(time_between = test_date_2 - test_date_1) %>% 
  na.omit()

three_mem_visual <- multiple_mem_visual %>% 
  select(c(1:4, 11:13)) %>% 
  arrange(passport_id) %>% 
  mutate(time_between_1_2 = test_date_2 - test_date_1) %>% 
  mutate(time_between_2_3 = test_date_3 - test_date_2) %>% 
  na.omit()

four_mem_visual <- multiple_mem_visual %>% 
  select(c(1:5, 11:14)) %>% 
  arrange(passport_id) %>% 
  mutate(time_between_1_2 = test_date_2 - test_date_1) %>% 
  mutate(time_between_2_3 = test_date_3 - test_date_2) %>% 
  mutate(time_between_3_4 = test_date_4 - test_date_3) %>% 
  na.omit()

five_mem_visual <- multiple_mem_visual %>% 
  select(c(1:6, 11:15)) %>% 
  arrange(passport_id) %>% 
  mutate(time_between_1_2 = test_date_2 - test_date_1) %>% 
  mutate(time_between_2_3 = test_date_3 - test_date_2) %>% 
  mutate(time_between_3_4 = test_date_4 - test_date_3) %>% 
  mutate(time_between_4_5 = test_date_5 - test_date_4) %>% 
  na.omit()

six_mem_visual <- multiple_mem_visual %>% 
  select(c(1:7, 11:16)) %>% 
  arrange(passport_id) %>% 
  na.omit()

seven_mem_visual <- multiple_mem_visual %>% 
  select(c(1:8, 11:17)) %>% 
  arrange(passport_id) %>% 
  na.omit()

eight_mem_visual <- multiple_mem_visual %>% 
  select(c(1:9, 11:18)) %>% 
  arrange(passport_id) %>% 
  na.omit()

nine_mem_visual <- multiple_mem_visual %>% 
  select(c(1:10, 11:19)) %>% 
  arrange(passport_id) %>% 
  na.omit()


#impulse control organization
multiple_impulse_control <- multiple_baseline %>% 
  group_by(passport_id) %>% 
  mutate(number = row_number()) %>% 
  ungroup() %>% 
  pivot_wider(
    id_cols = passport_id,
    names_from = number,
    values_from = c(test_date, user_impulse_control_composite_score),
    names_glue = "{.value}_{number}"
  ) 

one_impulse_control <- multiple_impulse_control %>% 
  select(c(1, 2, 11)) %>% 
  arrange(passport_id) %>% 
  na.omit()

two_impulse_control <- multiple_impulse_control %>% 
  select(c(1:3, 11:12)) %>% 
  arrange(passport_id) %>% 
  mutate(time_between = test_date_2 - test_date_1) %>% 
  na.omit()

three_impulse_control <- multiple_impulse_control %>% 
  select(c(1:4, 11:13)) %>% 
  arrange(passport_id) %>% 
  mutate(time_between_1_2 = test_date_2 - test_date_1) %>% 
  mutate(time_between_2_3 = test_date_3 - test_date_2) %>% 
  na.omit()

four_impulse_control <- multiple_impulse_control %>% 
  select(c(1:5, 11:14)) %>% 
  arrange(passport_id) %>% 
  mutate(time_between_1_2 = test_date_2 - test_date_1) %>% 
  mutate(time_between_2_3 = test_date_3 - test_date_2) %>% 
  mutate(time_between_3_4 = test_date_4 - test_date_3) %>% 
  na.omit()

five_impulse_control <- multiple_impulse_control %>% 
  select(c(1:6, 11:15)) %>% 
  arrange(passport_id) %>% 
  mutate(time_between_1_2 = test_date_2 - test_date_1) %>% 
  mutate(time_between_2_3 = test_date_3 - test_date_2) %>% 
  mutate(time_between_3_4 = test_date_4 - test_date_3) %>% 
  mutate(time_between_4_5 = test_date_5 - test_date_4) %>% 
  na.omit()

six_impulse_control <- multiple_impulse_control %>% 
  select(c(1:7, 11:16)) %>% 
  arrange(passport_id) %>% 
  na.omit()

seven_impulse_control <- multiple_impulse_control %>% 
  select(c(1:8, 11:17)) %>% 
  arrange(passport_id) %>% 
  na.omit()

eight_impulse_control <- multiple_impulse_control %>% 
  select(c(1:9, 11:18)) %>% 
  arrange(passport_id) %>% 
  na.omit()

nine_impulse_control <- multiple_impulse_control %>% 
  select(c(1:10, 11:19)) %>% 
  arrange(passport_id) %>% 
  na.omit()



#reaction time organization
multiple_reaction_time <- multiple_baseline %>% 
  group_by(passport_id) %>% 
  mutate(number = row_number()) %>% 
  ungroup() %>% 
  pivot_wider(
    id_cols = passport_id,
    names_from = number,
    values_from = c(test_date, user_reaction_time_composite_score),
    names_glue = "{.value}_{number}"
  ) 

one_reaction_time <- multiple_reaction_time %>% 
  select(c(1, 2, 11)) %>% 
  arrange(passport_id) %>% 
  na.omit()

two_reaction_time <- multiple_reaction_time %>% 
  select(c(1:3, 11:12)) %>% 
  arrange(passport_id) %>% 
  mutate(time_between = test_date_2 - test_date_1) %>% 
  na.omit()

three_reaction_time <- multiple_reaction_time %>% 
  select(c(1:4, 11:13)) %>% 
  arrange(passport_id) %>% 
  mutate(time_between_1_2 = test_date_2 - test_date_1) %>% 
  mutate(time_between_2_3 = test_date_3 - test_date_2) %>% 
  na.omit()

four_reaction_time <- multiple_reaction_time %>% 
  select(c(1:5, 11:14)) %>% 
  arrange(passport_id) %>% 
  mutate(time_between_1_2 = test_date_2 - test_date_1) %>% 
  mutate(time_between_2_3 = test_date_3 - test_date_2) %>% 
  mutate(time_between_3_4 = test_date_4 - test_date_3) %>% 
  na.omit()

five_reaction_time <- multiple_reaction_time %>% 
  select(c(1:6, 11:15)) %>% 
  arrange(passport_id) %>% 
  mutate(time_between_1_2 = test_date_2 - test_date_1) %>% 
  mutate(time_between_2_3 = test_date_3 - test_date_2) %>% 
  mutate(time_between_3_4 = test_date_4 - test_date_3) %>% 
  mutate(time_between_4_5 = test_date_5 - test_date_4) %>% 
  na.omit()

six_reaction_time <- multiple_reaction_time %>% 
  select(c(1:7, 11:16)) %>% 
  arrange(passport_id) %>% 
  na.omit()

seven_reaction_time <- multiple_reaction_time %>% 
  select(c(1:8, 11:17)) %>% 
  arrange(passport_id) %>% 
  na.omit()

eight_reaction_time <- multiple_reaction_time %>% 
  select(c(1:9, 11:18)) %>% 
  arrange(passport_id) %>% 
  na.omit()

nine_reaction_time <- multiple_reaction_time %>% 
  select(c(1:10, 11:19)) %>% 
  arrange(passport_id) %>% 
  na.omit()


#visual motor organization
multiple_visual_motor <- multiple_baseline %>% 
  group_by(passport_id) %>% 
  mutate(number = row_number()) %>% 
  ungroup() %>% 
  pivot_wider(
    id_cols = passport_id,
    names_from = number,
    values_from = c(test_date, user_visual_motor_composite_score),
    names_glue = "{.value}_{number}"
  ) 

one_visual_motor <- multiple_visual_motor %>% 
  select(c(1, 2, 11)) %>% 
  arrange(passport_id) %>% 
  na.omit()

two_visual_motor <- multiple_visual_motor %>% 
  select(c(1:3, 11:12)) %>% 
  arrange(passport_id) %>% 
  mutate(time_between = test_date_2 - test_date_1) %>% 
  na.omit()

three_visual_motor <- multiple_visual_motor %>% 
  select(c(1:4, 11:13)) %>% 
  arrange(passport_id) %>% 
  mutate(time_between_1_2 = test_date_2 - test_date_1) %>% 
  mutate(time_between_2_3 = test_date_3 - test_date_2) %>% 
  na.omit()

four_visual_motor <- multiple_visual_motor %>% 
  select(c(1:5, 11:14)) %>% 
  arrange(passport_id) %>% 
  mutate(time_between_1_2 = test_date_2 - test_date_1) %>% 
  mutate(time_between_2_3 = test_date_3 - test_date_2) %>% 
  mutate(time_between_3_4 = test_date_4 - test_date_3) %>% 
  na.omit()

five_visual_motor <- multiple_visual_motor %>% 
  select(c(1:6, 11:15)) %>% 
  arrange(passport_id) %>% 
  mutate(time_between_1_2 = test_date_2 - test_date_1) %>% 
  mutate(time_between_2_3 = test_date_3 - test_date_2) %>% 
  mutate(time_between_3_4 = test_date_4 - test_date_3) %>% 
  mutate(time_between_4_5 = test_date_5 - test_date_4) %>% 
  na.omit()

six_visual_motor <- multiple_visual_motor %>% 
  select(c(1:7, 11:16)) %>% 
  arrange(passport_id) %>% 
  na.omit()

seven_visual_motor <- multiple_visual_motor %>% 
  select(c(1:8, 11:17)) %>% 
  arrange(passport_id) %>% 
  na.omit()

eight_visual_motor <- multiple_visual_motor %>% 
  select(c(1:9, 11:18)) %>% 
  arrange(passport_id) %>% 
  na.omit()

nine_visual_motor <- multiple_visual_motor %>% 
  select(c(1:10, 11:19)) %>% 
  arrange(passport_id) %>% 
  na.omit()

# one baseline join
one_a <- full_join(one_mem_verbal, one_mem_visual)
one_b <- full_join(one_a, one_impulse_control)
one_c <- full_join(one_b, one_reaction_time)
one_baselines <- full_join(one_c, one_visual_motor)

# two baseline join
two_a <- full_join(two_mem_verbal, two_mem_visual)
two_b <- full_join(two_a, two_impulse_control)
two_c <- full_join(two_b, two_reaction_time)
two_baselines <- full_join(two_c, two_visual_motor)

# three baseline join
three_a <- full_join(three_mem_verbal, three_mem_visual)
three_b <- full_join(three_a, three_impulse_control)
three_c <- full_join(three_b, three_reaction_time)
three_baselines <- full_join(three_c, three_visual_motor)

# four baseline join
four_a <- full_join(four_mem_verbal, four_mem_visual)
four_b <- full_join(four_a, four_impulse_control)
four_c <- full_join(four_b, four_reaction_time)
four_baselines <- full_join(four_c, four_visual_motor)


# five baseline join
five_a <- full_join(five_mem_verbal, five_mem_visual)
five_b <- full_join(five_a, five_impulse_control)
five_c <- full_join(five_b, five_reaction_time)
five_baselines <- full_join(five_c, five_visual_motor)


# six baseline join
six_a <- full_join(six_mem_verbal, six_mem_visual)
six_b <- full_join(six_a, six_impulse_control)
six_c <- full_join(six_b, six_reaction_time)
six_baselines <- full_join(six_c, six_visual_motor)


# seven baseline join
seven_a <- full_join(seven_mem_verbal, seven_mem_visual)
seven_b <- full_join(seven_a, seven_impulse_control)
seven_c <- full_join(seven_b, seven_reaction_time)
seven_baselines <- full_join(seven_c, seven_visual_motor)

# eight baseline join
eight_a <- full_join(eight_mem_verbal, eight_mem_visual)
eight_b <- full_join(eight_a, eight_impulse_control)
eight_c <- full_join(eight_b, eight_reaction_time)
eight_baselines <- full_join(eight_c, eight_visual_motor)

# nine baseline join
nine_a <- full_join(nine_mem_verbal, nine_mem_visual)
nine_b <- full_join(nine_a, nine_impulse_control)
nine_c <- full_join(nine_b, nine_reaction_time)
nine_baselines <- full_join(nine_c, nine_visual_motor)

```


# What is the duration of time between baseline test administrations? {.tabset .tabset-fade .tabset-pills}
```{r test time, include=FALSE}

two_baselines <- two_baselines %>% 
  mutate(time_between = as.numeric(time_between)) 

mean_2(two_baselines$time_between)

three_baselines <- three_baselines %>% 
  mutate(time_between_1_2 = as.numeric(time_between_1_2)) %>% 
  mutate(time_between_2_3 = as.numeric(time_between_2_3))

four_baselines <- four_baselines %>% 
  mutate(time_between_1_2 = as.numeric(time_between_1_2)) %>% 
  mutate(time_between_2_3 = as.numeric(time_between_2_3)) %>% 
  mutate(time_between_3_4 = as.numeric(time_between_3_4))

five_baselines <- five_baselines %>% 
  mutate(time_between_1_2 = as.numeric(time_between_1_2)) %>% 
  mutate(time_between_2_3 = as.numeric(time_between_2_3)) %>% 
  mutate(time_between_3_4 = as.numeric(time_between_3_4)) %>% 
  mutate(time_between_4_5 = as.numeric(time_between_4_5))



time_react <- function(df, var) {
    df %>% 
      summarize(Mean = mean({{var}}),
                SD = sd({{var}}),
                Min = min({{var}}),
                Max = max({{var}}),
                Total = length({{var}})) %>% 
      mutate_if(is.numeric, round, 2) %>% 
      reactable(columns = list(
        Mean = colDef(format = colFormat(separators = TRUE, suffix = " days")),
        SD = colDef(format = colFormat(separators = TRUE, suffix = " days")),
        Min = colDef(format = colFormat(separators = TRUE, suffix = " days")),
        Max = colDef(format = colFormat(separators = TRUE, suffix = " days")),
        Total = colDef(format = colFormat(separators = TRUE, suffix = " individuals"))
      ))
}

time_react(two_baselines, time_between)
time_react(three_baselines, time_between_1_2)
time_react(three_baselines, time_between_2_3)


time_hist <- function(df, x) {
  ggplot(df, aes({{x}})) +
  geom_histogram(fill = "#56B4E9",
                color = "white", 
                alpha = 0.9,
                bins = 20) +
    labs(x = "Number of Days Between Baseline Tests",
         y = "Number of Individuals")
}

time_hist(two_baselines, time_between)
time_hist(three_baselines, time_between_2_3)
```

```{r, include=FALSE}
time_react(two_baselines, time_between)
```

## Two Baseline Tests {.tabset .tabset-fade .tabset-pills}

Of the 18,739 individuals who completed two baseline tests, the average number of days between test dates was observed to be 637.31 days with a standard deviation of 246.49 days. The minimum number of days between baseline test administrations was observed to be 0 days, while the maximum number of days was observed to be 2,737 days. 

### Summary

```{r}
time_react(two_baselines, time_between)
```

### Plot

```{r}
time_hist(two_baselines, time_between)
```

## Three Baseline Tests {.tabset .tabset-fade .tabset-pills}

Of the 2,930 individuals who received two baseline tests, the average number of days between the first and second test dates was observed to be 496.36 days with a standard deviation of 254.12 days. The minimum number of days between Baseline 1 and Baseline 2 was observed to be 0 days, while the maximum number of days was observed to be 2,526 days. The average number of days between the second and third test dates was observed to be 544.15 days with a standard deviation of 259.26 days. The minimum number of days between Baseline 2 and Baseline 3 was observed to be 0 days, while the maximum number of days was observed to be 1,374 days. A paired *T*-test was used to compare the mean duration of days between between Baselines tests 1 and 2 and Baseline tests 2 and 3. On average, the duration of time between Baseline 2 and 3 was significantly longer than the duration of time between Baseline 1 and 2, *t*(2929) = -7.556, *p* < .01. 

### Time Between Tests 1 and 2 Summary

```{r}
time_react(three_baselines, time_between_1_2)
```

### Time Between Tests 1 and 2 Plot

```{r}
time_hist(three_baselines, time_between_1_2)
```

### Time Between Tests 2 and 3 Summary

```{r}
time_react(three_baselines, time_between_2_3)
```

### Time Between Tests 2 and 3 Plot

```{r}
time_hist(three_baselines, time_between_2_3)
```

### Boxplot
```{r, include=FALSE}
three_baselines_long <- three_baselines %>% 
  pivot_longer(
    cols = c(8:9),
    names_to = "time_between",
    names_prefix = "time_between_",
    values_to = "days"
  )

ggplot(three_baselines_long, aes(time_between, days)) +
  geom_boxplot() +
  labs(x = "",
       y = "Number of Days")

time_box_p <- function(df, x, y) {
  ggplot(df, aes({{x}}, {{y}})) +
  geom_boxplot() +
  labs(x = "",
       y = "Number of Days")
}

```

```{r, include=TRUE}
time_box_p(three_baselines_long, time_between, days) +
  stat_compare_means(method = "t.test", paired = TRUE, hjust = -0.5)
```

### *T*-Test Results
```{r, include=FALSE}
mean_2(mem_verbal_all$user_memory_composite_score_verbal_1)
mean_2(mem_verbal_all$user_memory_composite_score_verbal_2)

three_baselines_1 <- three_baselines$time_between_1_2
three_baselines_2 <- three_baselines$time_between_2_3

three_baseline_time_res <- t.test(three_baselines_1, three_baselines_2, paired = TRUE)

three_baseline_time_res

mean_2(three_baselines$time_between_1_2)
mean_2(three_baselines$time_between_2_3)
```

```{r, include=TRUE}
three_baseline_time_res
```


## Four Baseline Tests {.tabset .tabset-fade .tabset-pills}

Of the 420 individuals who received four baseline tests, the average number of days between the first and second test dates was observed to be 355.26 days with a standard deviation of 226.45 days. The minimum number of days between Baseline 1 and Baseline 2 was observed to be 0 days, while the maximum number of days was observed to be 1,057 days. The average number of days between the second and third test dates was observed to be 363.70 days with a standard deviation of 227.67 days. The minimum number of days between Baseline 2 and Baseline 3 was observed to be 0 days, while the maximum number of days was observed to be 1,124 days. The average number of days between the third and fourth test dates was observed to be 361.59 days with a standard deviation of 239.15 days. The minimum number of days between Baseline 3 and Baseline 4 was observed to be 0 days, while the maximum number of days was observed to be 1,794 days. For individuals who completed four baseline tests, the duration of time between consecutive tests was not significantly different, *F*(1.91, 799.76) = 0.16, *p* = .85, generalized eta squared = 0.00024. 

### Time Between Tests 1 and 2 Summary

```{r}
time_react(four_baselines, time_between_1_2)
```

### Time Between Tests 1 and 2 Plot

```{r}
time_hist(four_baselines, time_between_1_2)
```

### Time Between Tests 2 and 3 Summary

```{r}
time_react(four_baselines, time_between_2_3)
```

### Time Between Tests 2 and 3 Plot

```{r}
time_hist(four_baselines, time_between_2_3)
```

### Time Between Tests 3 and 4 Summary

```{r}
time_react(four_baselines, time_between_3_4)
```

### Time Between Tests 3 and 4 Plot

```{r}
time_hist(four_baselines, time_between_3_4)
```

### Boxplot
```{r, include=FALSE}
four_baselines_long <- four_baselines %>% 
  pivot_longer(
    cols = c(10:12),
    names_to = "time_between",
    names_prefix = "time_between_",
    values_to = "days"
  )
```

```{r, include=TRUE}
time_box_p(four_baselines_long, time_between, days) 
```

### ANOVA Computation

```{r, include=FALSE}
four_baselines_res <- anova_test(four_baselines_long, 
                                 dv = days,
                                 wid = passport_id, 
                                 within = time_between)

```

```{r, include=TRUE}
get_anova_table(four_baselines_res)
```

### Pairwise Comparisons 

```{r, include=FALSE}
four_baselines_pwc <- four_baselines_long %>% 
  pairwise_t_test(
    days ~ time_between, paired = TRUE,
    p.adjust.method = "bonferroni"
  )

four_baselines_pwc
```

```{r, include=TRUE}
four_baselines_pwc %>% 
  reactable()
```

### Result Visualization
```{r, include=FALSE}
four_baselines_pwc <- four_baselines_pwc %>% 
  add_xy_position(x = "time_between")

time_box_p(four_baselines_long, time_between, days) +
  stat_pvalue_manual(four_baselines_pwc) +
  labs(
    subtitle = get_test_label(four_baselines_res, detailed = TRUE),
    caption = get_pwc_label(four_baselines_pwc)
  )
```

```{r, include=TRUE}
time_box_p(four_baselines_long, time_between, days) +
  stat_pvalue_manual(four_baselines_pwc) +
  labs(
    subtitle = get_test_label(four_baselines_res, detailed = TRUE),
    caption = get_pwc_label(four_baselines_pwc)
  )
```


## Five Baseline Tests {.tabset .tabset-fade .tabset-pills}

Of the 78 individuals who received five baseline tests, the average number of days between the first and second test dates was observed to be 286.50 days with a standard deviation of 230.45 days. The minimum number of days between Baseline 1 and Baseline 2 was observed to be 1 day, while the maximum number of days was observed to be 763 days. The average number of days between the second and third test dates was observed to be 291.17 days with a standard deviation of 231.50 days. The minimum number of days between Baseline 2 and Baseline 3 was observed to be 1 day, while the maximum number of days was observed to be 855 days. The average number of days between the third and fourth test dates was observed to be 235.29 days with a standard deviation of 209.18 days. The minimum number of days between Baseline 3 and Baseline 4 was observed to be 1 day, while the maximum number of days was observed to be 914 days. The average number of days between the fourth and fifth test dates was observed to be 266.26 days with a standard deviation of 222.77 days. The minimum number of days between Baseline 4 and Baseline 5 was observed to be 0 days, while the maximum number of days was observed to be 873 days. For individuals who completed five baseline tests, the duration of time between consecutive tests was not significantly different, *F*(3, 231) = 1.03, *p* = .38, generalized eta squared = 0.01. 

### Time Between Tests 1 and 2 Summary

```{r}
time_react(five_baselines, time_between_1_2)
```

### Time Between Tests 1 and 2 Plot

```{r}
time_hist(five_baselines, time_between_1_2)
```

### Time Between Tests 2 and 3 Summary

```{r}
time_react(five_baselines, time_between_2_3)
```

### Time Between Tests 2 and 3 Plot

```{r}
time_hist(five_baselines, time_between_2_3)
```

### Time Between Tests 3 and 4 Summary

```{r}
time_react(five_baselines, time_between_3_4)
```

### Time Between Tests 3 and 4 Plot

```{r}
time_hist(five_baselines, time_between_3_4)
```

### Time Between Tests 4 and 5 Summary

```{r}
time_react(five_baselines, time_between_4_5)
```

### Time Between Tests 4 and 5 Plot

```{r}
time_hist(five_baselines, time_between_4_5)
```

### Boxplot

```{r, include=FALSE}
five_baselines_long <- five_baselines %>% 
  pivot_longer(
    cols = c(12:15),
    names_to = "time_between",
    names_prefix = "time_between_",
    values_to = "days"
  )
```

```{r, include=TRUE}
time_box_p(five_baselines_long, time_between, days)
```

### ANOVA Computation

```{r, include=FALSE}
five_baselines_res <- anova_test(five_baselines_long, 
                                 dv = days,
                                 wid = passport_id, 
                                 within = time_between)

```

```{r, include=TRUE}
get_anova_table(five_baselines_res)
```

### Pairwise Comparisons 

```{r, include=FALSE}
five_baselines_pwc <- five_baselines_long %>% 
  pairwise_t_test(
    days ~ time_between, paired = TRUE,
    p.adjust.method = "bonferroni"
  )

five_baselines_pwc
```

```{r, include=TRUE}
five_baselines_pwc %>% 
  reactable()
```

### Result Visualization

```{r, include=FALSE}
five_baselines_pwc <- five_baselines_pwc %>% 
  add_xy_position(x = "time_between")

time_box_p(five_baselines_long, time_between, days) +
  stat_pvalue_manual(five_baselines_pwc) +
  labs(
    subtitle = get_test_label(five_baselines_res, detailed = TRUE),
    caption = get_pwc_label(five_baselines_pwc)
  )
```

```{r, include=TRUE}
time_box_p(five_baselines_long, time_between, days) +
  stat_pvalue_manual(five_baselines_pwc) +
  labs(
    subtitle = get_test_label(five_baselines_res, detailed = TRUE),
    caption = get_pwc_label(five_baselines_pwc)
  )
```

